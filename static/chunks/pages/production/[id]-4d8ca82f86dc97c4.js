(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3197],{8103:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/production/[id]",function(){return o(9053)}])},9053:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return I}});var a=o(5893),r=o(7294),n=o(1163),l=o(2896),s=o(8650),i=o(9403),c=o(7388),d=o(4420),u=o(7858),m=o(4644);let p=e=>{let{visible:t,onHide:o,onConfirm:r,text:n}=e,l=(0,a.jsxs)("div",{children:[(0,a.jsx)(i.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-danger",onClick:o}),(0,a.jsx)(i.z,{label:"OK",icon:"pi pi-check",className:"p-button-success",onClick:r})]});return(0,a.jsx)(u.V,{header:"\xa1Warning!",visible:t,style:{width:"30vw"},footer:l,onHide:o,children:(0,a.jsx)("div",{className:"p-grid p-dir-col",children:(0,a.jsx)(m.v,{severity:"warn",text:n})})})};o(4569),o(7795),o(520),o(2505);var y=o(6094),h=o(1202),b=o(6339);let v=e=>{let t=JSON.parse(sessionStorage.getItem("ordersInProgress"))||[];t.includes(e)||(t.push(e),sessionStorage.setItem("ordersInProgress",JSON.stringify(t)))},P=e=>{let t=new Date,o=new Date(t),a=t.getHours();a<6&&o.setDate(o.getDate()-1);let r=new Date(o.getFullYear(),0,0),n=o.getFullYear().toString().slice(-2),l=Math.floor((o-r)/864e5).toString().padStart(3,"0")+n,s="".concat(l," ").concat(e);return s},x=e=>{let{visible:t,onHide:o,data:n,pallet:c,onSave:m,parentEntry:p}=e,x="http://localhost:3000/api/backend",[g,N]=(0,r.useState)({wetTime:"",dryTime:"",rows:[]}),[w,D]=(0,r.useState)(!1),f=(0,r.useRef)(null),[S,j]=(0,r.useState)(localStorage.getItem("shift")),[C,T]=(0,r.useState)(localStorage.getItem("line")),E=(e,t)=>{let o=new Date(e),a=parseFloat(t);return o.setDate(o.getDate()+a),o};(0,r.useEffect)(()=>{t||N({wetTime:"",dryTime:"",rows:[]})},[t]),(0,r.useEffect)(()=>{if(n){let e=Array.isArray(n)?n.map(e=>({wetTime:"",dryTime:"",LineNum:e.LineNum,Und:e.Und,baseEntry:e.DocEntry,product:e.ItemCode2,description:e.ItemName,real:e.ProduccionGO?Number(e.BaseQtyLine*(e.PlannedQty-e.CmpltQty>=e.UndXPallet?e.UndXPallet:e.PlannedQty-e.CmpltQty)).toFixed(3):Number(e.BaseQtyLine*(e.PlannedQty-e.CmpltQty>1?1:e.PlannedQty-e.CmpltQty)).toFixed(3),base:Number(e.BaseQtyLine).toFixed(3),wareHouse:e.wareHouse,lotNumbers:[{lotNumber:"",quantity:e.ProduccionGO?Number(e.BaseQtyLine*(e.PlannedQty-e.CmpltQty>=e.UndXPallet?e.UndXPallet:e.PlannedQty-e.CmpltQty)).toFixed(3):Number(e.BaseQtyLine*(e.PlannedQty-e.CmpltQty>1?1:e.PlannedQty-e.CmpltQty)).toFixed(3)}],lotOptions:[],batch:e.Batch})):[{product:n.ItemCode2,Und:n.Und,description:n.ItemName,base:n.BaseQty,real:"",lotNumbers:[{lotNumber:"",quantity:""}],lotOptions:[]}];N({...g,rows:e})}},[n]);let F=async(e,t,o)=>{try{let a=await fetch("/api/LotsByItem?item='".concat(e,"'&warehouse='").concat(t,"'")),r=await a.json(),n=r.map(e=>({label:"LOT:".concat(e.BatchNum,"  | QTY:").concat(Number(e.Quantity).toFixed(3)),value:e.BatchNum,quantity:e.Quantity}));N(e=>{let t={...e};return t.rows[o].lotOptions=n,t})}catch(e){console.error("Error fetching lots:",e)}},L=(e,t,o)=>{if(null!=t){let a=g.rows.map((a,r)=>r===t?{...a,[o]:e.target.value}:a);N({...g,rows:a})}else N({...g,[o]:e.target.value})},O=(e,t,o,a)=>{let r=g.rows.map((r,n)=>{if(n===t){let t=r.lotNumbers.map((t,r)=>r===o?{...t,[a]:e.target.value}:t);return{...r,lotNumbers:t}}return r});N({...g,rows:r})},I=e=>{let t=g.rows.map((t,o)=>o===e&&t.lotNumbers.length<3?{...t,lotNumbers:[...t.lotNumbers,{lotNumber:"",quantity:""}]}:t);N({...g,rows:t})},B=(e,t)=>{let o=g.rows.map((o,a)=>{if(a===e){let e=o.lotNumbers.filter((e,o)=>o!==t);return{...o,lotNumbers:e}}return o});N({...g,rows:o})},U=()=>{let e=!0;for(let t of g.rows){let o=t.lotNumbers.reduce((e,t)=>e+(t.quantity?parseFloat(t.quantity):0),0);parseFloat(t.real)>o&&"Y"===t.batch&&(f.current.show({severity:"warn",summary:"Warning",detail:"The quantity cannot exceed the total available in the selected lots."}),e=!1),"Y"===t.batch&&t.lotNumbers.some(e=>!e.lotNumber)&&(f.current.show({severity:"warn",summary:"Warning",detail:"All batch items must have a selected lot."}),e=!1)}return e},Q=()=>{var e,t,o;let a=[{baseEntry:n[0].DocEntry,baseType:202,itemCode:n[0].ItemCode,quantity:parseFloat(n[0].PlannedQty-n[0].CmpltQty>1?1:n[0].PlannedQty-n[0].CmpltQty).toFixed(3),WareHouse:n[0].Warehouse,DocumentLinesBinAllocations:[{AllowNegativeQuantity:"Y",BaseLineNumber:0,BinAbsEntry:3233,quantity:parseFloat(n[0].PlannedQty-n[0].CmpltQty>1?1:n[0].PlannedQty-n[0].CmpltQty).toFixed(3)}],documentLinesBatchNumbers:[{batchNumber:P(null===(e=n[0])||void 0===e?void 0:e.PlantId),AddmisionDate:new Date().toLocaleDateString(),ExpirationDate:E(new Date,null===(t=n[0])||void 0===t?void 0:t.BestBeforeDays).toLocaleDateString(),notes:"NOTA LOTE ".concat(P(null===(o=n[0])||void 0===o?void 0:o.PlantId)),quantity:parseFloat(n[0].PlannedQty-n[0].CmpltQty>1?1:n[0].PlannedQty-n[0].CmpltQty).toFixed(3)}]}];return{U_CTS_POG:String(n[0].POParentDocEntry),U_CTS_TURNO:S,U_CTS_PLine:C,docDate:new Date().toLocaleDateString(),docDueDate:new Date().toLocaleDateString(),comments:"Source: Portal Production Web",documentType:"ReceiptFromProduction",documentLines:a}},k=async()=>{if(!U())return;D(!0);let e=g.rows.filter(e=>e.real&&parseFloat(e.real)>0),t={U_CTS_TIMEW:g.wetTime,U_CTS_TIMED:g.dryTime,U_CTS_TURNO:S,U_CTS_PLine:C,docDate:new Date().toLocaleDateString(),docDueDate:new Date().toLocaleDateString(),comments:"Source: Portal Production Web",documentType:"IssueForProduction",documentLines:e.map((e,t)=>({baseEntry:e.baseEntry,baseLine:e.LineNum,baseType:202,itemCode:e.product,quantity:parseFloat(e.real),WareHouse:e.wareHouse,..."Y"===e.batch&&{documentLinesBatchNumbers:e.lotNumbers.map((e,o)=>({batchNumber:e.lotNumber,notes:"NOTA LOTE ".concat(e.lotNumber),quantity:parseFloat(e.quantity||0),baseLineNumber:t}))}}))};try{let e=localStorage.getItem("Token"),a=await fetch("".concat(x,"/Production/PostIssue4Production"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)}),r=await a.json();if(a.ok){if(f.current.show({severity:"success",summary:"Success",detail:r.Message}),v(p),!n[0].ProduccionGO){let t=Q(),o=await fetch("".concat(x,"/Production/PostReceiptFromProduction"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)}),a=await o.json();o.ok?f.current.show({severity:"success",summary:"Success",detail:a.Message}):f.current.show({severity:"error",summary:"Error",detail:a.Message})}o(!1),m(!0)}else f.current.show({severity:"error",summary:"Error",detail:r.Message})}catch(e){console.error("Error:",e),f.current.show({severity:"error",summary:"Error",detail:"An unexpected error occurred"})}finally{D(!1)}},_=async()=>{if(!U())return;D(!0);let e=g.rows.filter(e=>e.real&&parseFloat(e.real)>0),t={U_CTS_TIMEW:g.wetTime,U_CTS_TIMED:g.dryTime,U_CTS_TURNO:S,U_CTS_PLine:C,docDate:new Date().toLocaleDateString(),docDueDate:new Date().toLocaleDateString(),comments:"Source: Portal Production Web",documentType:"IssueForProduction",documentLines:e.map((e,t)=>({baseEntry:e.baseEntry,baseLine:e.LineNum,baseType:202,itemCode:e.product,quantity:parseFloat(e.real),WareHouse:e.wareHouse,..."Y"===e.batch&&{documentLinesBatchNumbers:e.lotNumbers.map((e,o)=>({batchNumber:e.lotNumber,notes:"NOTA LOTE ".concat(e.lotNumber),quantity:parseFloat(e.quantity||0),baseLineNumber:t}))}}))};try{let e=localStorage.getItem("Token"),a=await fetch("".concat(x,"/Production/PostIssue4Production"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)}),r=await a.json();if(a.ok){if(f.current.show({severity:"success",summary:"Success",detail:r.Message}),v(p),n[0].ProduccionGO)o(!0);else{let t=Q(),o=await fetch("".concat(x,"/Production/PostReceiptFromProduction"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)}),a=await o.json();o.ok?f.current.show({severity:"success",summary:"Success",detail:a.Message}):f.current.show({severity:"error",summary:"Error",detail:a.Message})}}else f.current.show({severity:"error",summary:"Error",detail:r.Message})}catch(e){console.error("Error:",e),f.current.show({severity:"error",summary:"Error",detail:"An unexpected error occurred"})}finally{D(!1)}},A=(e,t)=>{var o;let r=e.lotNumbers.length>1;return null==e?void 0:null===(o=e.lotNumbers)||void 0===o?void 0:o.map((o,n)=>(0,a.jsxs)("div",{className:"lote-detail",children:[(0,a.jsx)("div",{className:"p-col-4",style:{width:"150px",fontSize:"12px"},children:(0,a.jsx)(h.L,{value:o.lotNumber,options:e.lotOptions,onChange:e=>O(e,t,n,"lotNumber"),onFocus:()=>F(e.product,e.wareHouse,t),placeholder:"Select Lot",style:{width:"150px",fontSize:"12px"}})}),(0,a.jsx)("div",{className:"p-col-4",children:(0,a.jsxs)("div",{className:"p-col-2",children:[r&&(0,a.jsx)(i.z,{icon:"pi pi-times",className:"p-button-text p-button-danger",onClick:()=>B(t,n),style:{color:"red"}}),(0,a.jsx)(y.o,{value:o.quantity,onChange:e=>O(e,t,n,"quantity"),placeholder:"Lot Quantity",type:"number",step:"0.01",style:{width:"150px",fontSize:"12px"}})]})})]},"".concat(t,"-").concat(n)))},q=(0,a.jsx)("div",{className:"Times",children:(0,a.jsxs)("div",{className:"Times-detail",children:[(0,a.jsxs)("div",{className:"Times-child",children:[(0,a.jsx)("label",{children:"Wet Mix Time:"}),(0,a.jsx)(y.o,{value:g.wetTime,onChange:e=>L(e,null,"wetTime"),type:"number",step:"0.01",placeholder:"Quantity",style:{width:"7rem",fontSize:"12px"}})]}),(0,a.jsxs)("div",{className:"Times-child",children:[(0,a.jsx)("label",{children:"Dry Mix Time:"}),(0,a.jsx)(y.o,{value:g.dryTime,onChange:e=>L(e,null,"dryTime"),type:"number",step:"0.01",placeholder:"Quantity",style:{width:"7rem",fontSize:"12px"}})]})]})}),M=(0,a.jsxs)("div",{className:"p-d-flex p-jc-end",children:[!c&&(0,a.jsx)("div",{children:q}),(0,a.jsx)(i.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-danger p-mr-2",onClick:()=>o(!1)}),!c&&(0,a.jsx)(i.z,{label:"Save",icon:"pi pi-check",className:"p-button-success",onClick:k}),"Y"===c&&(0,a.jsx)(i.z,{label:"Pallet",icon:"pi pi-check",className:"p-button-success",onClick:_})]});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.F,{ref:f,position:"top-right",style:{marginTop:"60px",zIndex:9999}}),(0,a.jsxs)(u.V,{header:"Issue Components",visible:t,onHide:()=>o(!1),footer:M,className:"good-issue-dialog",children:[w&&(0,a.jsx)(b.G,{style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"}}),(0,a.jsxs)(l.w,{value:g.rows,scrollable:!0,scrollHeight:"500px",children:[(0,a.jsx)(s.s,{field:"product",header:"Product"}),(0,a.jsx)(s.s,{field:"description",header:"Description"}),(0,a.jsx)(s.s,{field:"base",header:"Base"}),(0,a.jsx)(s.s,{field:"real",header:"Real",body:(e,t)=>{var o;return(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(y.o,{value:e.real,onChange:e=>L(e,t.rowIndex,"real"),type:"number",step:"0.01",placeholder:"Quantity",style:{width:"7rem",fontSize:"12px"}}),(0,a.jsx)("span",{className:"p-inputgroup-addon",children:(null===(o=g.rows[0])||void 0===o?void 0:o.Und)||""})]})}}),(0,a.jsx)(s.s,{field:"lotNumbers",header:"Lot Numbers",body:(e,t)=>"Y"===e.batch?A(e,t.rowIndex):""}),(0,a.jsx)(s.s,{body:(e,t)=>"Y"===e.batch?(0,a.jsx)(i.z,{label:"",icon:"pi pi-plus",className:"p-button-secondary",onClick:()=>I(t.rowIndex)}):""})]})]})]})};var g=o(8504),N=o(7632);let w=e=>{let t=(0,N.Z)().replace(/-/g,"");return t.substring(0,e)},D=e=>{let{data:t,visible:o,onHide:n}=e,l="http://localhost:3000/api/backend",[s,m]=(0,r.useState)({warehouse:t.warehouse,po:(null==t?void 0:t.codigo)||"",sku:(null==t?void 0:t.ItemCode)||"",bestBefore:t.bestBefore||"",casePerPallet:"",quantity:"",of:"",palletX:"",binLocation:t.binCode,allocated:"",DueDate:null==t?void 0:t.dueDate,baseEntry:null==t?void 0:t.baseEntry,DocEntryParent:null==t?void 0:t.DocEntryParent,LineNumParent:null==t?void 0:t.LineNumParent,lots:[{lotNumber:P(null==t?void 0:t.PlantId),quantity:""}],ParentItemCode:null==t?void 0:t.ParentItemCode,ProduccionGO:t.ProduccionGO,UndXPallet:Number(t.UndXPallet).toFixed(0),PalletDetail:"",PalletsFlt:t.PalletsFlt}),[p,v]=(0,r.useState)([]),[x,N]=(0,r.useState)(!1),D=(0,r.useRef)(null),[f,S]=(0,r.useState)(""),[j,C]=(0,r.useState)(""),[T,E]=(0,r.useState)(localStorage.getItem("shift")),[F,L]=(0,r.useState)(localStorage.getItem("line"));(0,r.useEffect)(()=>{t&&m(e=>({...e,binLocation:t.binCode,bestBefore:t.bestBefore||"",warehouse:t.warehouse,po:(null==t?void 0:t.codigo)||"",sku:(null==t?void 0:t.ItemCode)||"",DueDate:null==t?void 0:t.dueDate,baseEntry:null==t?void 0:t.baseEntry,DocEntryParent:null==t?void 0:t.DocEntryParent,LineNumParent:null==t?void 0:t.LineNumParent,lots:[{lotNumber:P(null==t?void 0:t.PlantId),quantity:""}],ParentItemCode:null==t?void 0:t.ParentItemCode,ProduccionGO:t.ProduccionGO,UndXPallet:Number(t.UndXPallet).toFixed(0),PalletsFlt:t.PalletsFlt}))},[t]);let O=e=>{let{name:t,value:o}=e.target;m({...s,[t]:o})},I=(e,t)=>{let{name:o,value:a}=t.target,r=[...null==s?void 0:s.lots];r[e][o]=a,m({...s,lots:r})},B=async()=>{if(s.warehouse)try{let e=await fetch("/api/BinLocationByWarehouse?warehouse='".concat(s.warehouse,"'")),t=await e.json(),o=t.map(e=>({label:"".concat(e.BinCode),value:e.AbsEntry}));v(o)}catch(e){console.error("Error fetching bin locations:",e),D.current.show({severity:"error",summary:"Error",detail:"Failed to fetch bin locations"})}},U=e=>{console.log(e.value),m({...s,binLocation:e.value})},Q=async(e,t,o,a)=>{try{let r=await fetch("/api/DoughInfoByPO?id=".concat(e,"&full='").concat(a,"'")),n=await r.json();console.log(n);let l=n.reduce((e,a,r)=>(e[a.ItemCode]||(e[a.ItemCode]={baseEntry:o,baseLine:a.BaseLinNum,baseType:202,itemCode:a.ItemCode,quantity:parseFloat(a.Quantity),WareHouse:t,documentLinesBatchNumbers:[]}),e[a.ItemCode].documentLinesBatchNumbers.push({batchNumber:a.BatchNum,notes:"NOTA LOTE ".concat(a.BatchNum),quantity:parseFloat(a.QuantityBatch),baseLineNumber:0}),e),{}),s=Object.values(l).map(e=>({...e,quantity:e.documentLinesBatchNumbers.reduce((e,t)=>e+t.quantity,0),documentLinesBatchNumbers:e.documentLinesBatchNumbers})),i={U_CTS_TURNO:T,U_CTS_PLine:F,docDate:new Date().toLocaleDateString(),docDueDate:new Date().toLocaleDateString(),documentType:"IssueForProduction",comments:"Source: Portal Production Web-Issue based on ReceiptFromProduction ".concat(e),documentLines:s};return i}catch(e){console.error("Error fetching dough reception data:",e),D.current.show({severity:"error",summary:"Error",detail:"Failed to fetch dough reception data"})}},k=()=>{console.log(t.PalletsFlt),console.log(t.unitsPerPallet);let e=s.lots.map((e,o)=>({baseEntry:t.baseEntry,baseType:202,itemCode:t.ItemCode,quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt),WareHouse:t.warehouse,DocumentLinesBinAllocations:[{AllowNegativeQuantity:"Y",BaseLineNumber:o,BinAbsEntry:t.binEntry,Quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt)}],documentLinesBatchNumbers:[{batchNumber:e.lotNumber,AddmisionDate:new Date().toLocaleDateString(),ExpirationDate:s.bestBefore.toLocaleDateString(),notes:"NOTA LOTE ".concat(e.lotNumber),quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt)}]}));return{U_CTS_TURNO:T,U_CTS_PLine:F,docDate:new Date().toLocaleDateString(),docDueDate:new Date().toLocaleDateString(),comments:"Source: Portal Production Web",documentType:"ReceiptFromProduction",documentLines:e}},_=e=>{let o=s.lots.map((e,o)=>({baseEntry:s.DocEntryParent,baseLine:t.LineNumParent,baseType:202,itemCode:t.ItemCode,quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt),WareHouse:t.warehouse,documentLinesBatchNumbers:[{batchNumber:e.lotNumber,notes:"NOTA LOTE ".concat(e.lotNumber),quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt),baseLineNumber:o}]}));return{U_CTS_TURNO:T,U_CTS_PLine:F,docDate:new Date().toLocaleDateString(),docDueDate:new Date().toLocaleDateString(),documentType:"IssueForProduction",comments:"Source: Portal Production Web-Issue based on ReceiptFromProduction",documentLines:o}},A=()=>{let e=s.lots.map((e,o)=>({baseEntry:s.DocEntryParent,baseType:202,itemCode:s.ParentItemCode,quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt),WareHouse:t.warehouse,DocumentLinesBinAllocations:[{AllowNegativeQuantity:"Y",BaseLineNumber:o,BinAbsEntry:s.binLocation,Quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt)}],documentLinesBatchNumbers:[{batchNumber:e.lotNumber,AddmisionDate:new Date().toLocaleDateString(),ExpirationDate:s.bestBefore.toLocaleDateString(),notes:"NOTA LOTE ".concat(e.lotNumber),quantity:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt)}]}));return{U_CTS_TURNO:T,U_CTS_PLine:F,docDate:new Date().toLocaleDateString(),docDueDate:new Date().toLocaleDateString(),comments:"Source: Portal Production Web based on ReceiptFromProduction",documentType:"ReceiptFromProduction",documentLines:e}},q=async()=>{N(!0);let e=R(t.UndXPallet,t);console.log(e);try{let o=localStorage.getItem("Token"),a=await Q(t.baseEntry,t.warehouse,t.DocEntryParent,parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt)),r=k();console.log("1-->"),console.log(r);let s=await M("".concat(l,"/Production/PostReceiptFromProduction"),r,o,"Receipt");if(s&&"Y"===t.ProduccionGO){console.log("adentro de issue en padres");let r=_(s.DocEntry);console.log("2-->"),console.log(r),console.log("3-->"),console.log(a);let i=await M("".concat(l,"/Production/PostIssue4Production"),r,o,"Issue"),c=await M("".concat(l,"/Production/PostIssue4Production"),a,o,"Dough Reception Issue");if(i&&c&&"Y"===t.ProduccionGO){let e=A();console.log("4-->"),console.log(e),await M("".concat(l,"/Production/PostReceiptFromProduction"),e,o,"Receipt Finish Good")}console.log(e),await M("".concat(l,"/Production/PostArtSNPallets"),e,o,"Pallet"),D.current.show({severity:"success",summary:"Success",detail:"All documents created successfully"}),n(),m({warehouse:t.warehouse,po:(null==t?void 0:t.codigo)||"",sku:(null==t?void 0:t.ItemCode)||"",bestBefore:"",casePerPallet:"",quantity:"",of:"",palletX:"",binLocation:"",allocated:"",DueDate:null==t?void 0:t.dueDate,baseEntry:null==t?void 0:t.baseEntry,DocEntryParent:null==t?void 0:t.DocEntryParent,LineNumParent:null==t?void 0:t.LineNumParent,lots:[{lotNumber:"",quantity:""}],ParentItemCode:null==t?void 0:t.ParentItemCode})}else s&&"Y"!==t.ProduccionGO&&(s?(D.current.show({severity:"success",summary:"Success",detail:"All documents created successfully"}),n(),m({warehouse:t.warehouse,po:(null==t?void 0:t.codigo)||"",sku:(null==t?void 0:t.ItemCode)||"",bestBefore:"",casePerPallet:"",quantity:"",of:"",palletX:"",binLocation:"",allocated:"",DueDate:null==t?void 0:t.dueDate,baseEntry:null==t?void 0:t.baseEntry,DocEntryParent:null==t?void 0:t.DocEntryParent,LineNumParent:null==t?void 0:t.LineNumParent,lots:[{lotNumber:"",quantity:""}],ParentItemCode:null==t?void 0:t.ParentItemCode})):D.current.show({severity:"error",summary:"Error",detail:"An unexpected error occurred"}))}catch(e){var o;console.error("Error:",e),null==D||null===(o=D.current)||void 0===o||o.show({severity:"error",summary:"Error",detail:"An unexpected error occurred"})}finally{N(!1)}},M=async(e,t,o,a)=>{try{let r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify(t)}),n=await r.json();if(!r.ok)return console.log(n),D.current.show({severity:"error",summary:"".concat(a," Error"),detail:n.Message}),null;return n}catch(e){return console.error("Error creating ".concat(a,":"),e),D.current.show({severity:"error",summary:"".concat(a," Error"),detail:"An unexpected error occurred"}),null}},z=(e,t)=>{let o=Math.floor(e/t),a=e%t,r="".concat(o||0," Pallets of ").concat(Number(t).toFixed(0));return a>0&&(r+=" & 1 Pallets of ".concat(a),S(a),C(o)),{totalPallets:Math.ceil(e/t),palletDetail:r}},X=e=>{let{name:o,value:a}=e.target,r=parseFloat(a),{totalPallets:n,palletDetail:l}=z(r,t.UndXPallet);m({...s,[o]:a,casePerPallet:n,PalletDetail:l})},R=(e,t)=>{let o={IdPallet:w(20),Sku:t.ParentItemCode,Batch:s.lots[0].lotNumber,BestBefore:null==s?void 0:s.bestBefore.toLocaleDateString(),CasePallet:parseInt(e,10),Quantity:s.PalletsFlt>=e?e.toString():s.PalletsFlt.toString(),BinLocation:s.binLocation.toString(),DocEntryPO:s.DocEntryParent,Status:null};return o},H=(0,a.jsxs)("div",{children:[(0,a.jsx)(i.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-danger p-mr-2",onClick:n}),(0,a.jsx)(i.z,{label:"Save",icon:"pi pi-check",className:"p-button-success",style:{marginLeft:"0.5em"},onClick:q})]});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.F,{ref:D,position:"top-right",style:{marginTop:"60px",zIndex:9999}}),(0,a.jsx)(u.V,{header:"Product Reception",visible:o,onHide:n,footer:H,children:(0,a.jsx)(c.Z,{title:(null==t?void 0:t.ItemCode)+":"+(null==t?void 0:t.ProdName),children:(0,a.jsxs)("div",{className:"p-fluid",children:[x&&(0,a.jsx)("div",{className:"p-mb-3",children:(0,a.jsx)(b.G,{style:{width:"50px",height:"50px",display:"block",margin:"0 auto"}})}),(0,a.jsxs)("div",{className:"final-product",children:[(0,a.jsxs)("div",{className:"p-grid p-align-center",children:[(0,a.jsxs)("div",{className:"p-col-6",children:[(0,a.jsx)("label",{htmlFor:"lot",children:"LOT:"}),(0,a.jsx)(y.o,{id:"lot",name:"lotNumber",value:null==s?void 0:s.lots[0].lotNumber,onChange:e=>I(0,e),disabled:!0})]}),(0,a.jsxs)("div",{className:"p-col-6",children:[(0,a.jsx)("label",{htmlFor:"bestBefore",children:"Best Before:"}),(0,a.jsx)(g.f,{id:"bestBefore",name:"bestBefore",value:s.bestBefore,onChange:e=>O({target:{name:"bestBefore",value:e.value}}),dateFormat:"mm/dd/yy",disabled:!0})]})]}),(0,a.jsxs)("div",{className:"p-grid p-align-center",children:[(0,a.jsxs)("div",{className:"p-col-6",children:[(0,a.jsx)("label",{htmlFor:"quantity",children:"Quantity:"}),(0,a.jsx)(y.o,{id:"quantity",name:"quantity",value:parseFloat(t.PalletsFlt>=Number(t.UndXPallet).toFixed(0)?Number(t.UndXPallet).toFixed(0):t.PalletsFlt),onChange:X})]}),(0,a.jsxs)("div",{className:"p-col-6",children:[(0,a.jsx)("label",{htmlFor:"binLocation",children:"Bin Location:"}),(0,a.jsx)(h.L,{id:"binLocation",name:"binLocation",value:s.binLocation,options:p,onChange:U,onFocus:B,optionLabel:"label",placeholder:"Select a Bin Location"})]})]})]})]})})})]})};var f=o(9332);let S=()=>{let e=(0,f.useRouter)(),t=()=>{e.back()};return(0,a.jsx)(i.z,{icon:"pi pi-arrow-left",className:"p-button-secondary p-mr-2",onClick:t,label:"",text:!0})},j=e=>{var t;let{startTime:o,endTime:n,pauseTime:l,IsPaused:s,restarTime:i}=e,[d,u]=(0,r.useState)(new Date);(0,r.useEffect)(()=>{let e=setInterval(()=>{u(new Date)},1e3);return()=>clearInterval(e)},[]);let m=new Date(o),p=n?new Date(n):d;return t="Y"===s?l:((e,t)=>{let o=t-e,a=Math.floor(o%36e5/6e4),r=Math.floor(o%6e4/1e3);return"".concat(Math.floor(o/36e5),":").concat(a<10?"0":"").concat(a,":").concat(r<10?"0":"").concat(r," Hrs")})(i&&"N"===s?i:m,p),(0,a.jsx)(c.Z,{title:"Running time",subTitle:null===o?"":t,className:"p-card p-mt-3"})};var C=o(3540);let T=e=>{let{id:t,visible:o,onHide:n}=e,[l,s]=(0,r.useState)([]),[c,m]=(0,r.useState)([]),[p,y]=(0,r.useState)({}),[h,b]=(0,r.useState)(null),v=(0,r.useRef)(null);(0,r.useEffect)(()=>{t&&o&&P(t)},[t,o]);let P=async e=>{try{let t=await fetch("/api/ProductionMixes?id=".concat(e));if(!t.ok)throw Error("Network response was not ok");let o=await t.json();if(o.length>0){let e=o.map(e=>{let{DocEntry:t,CreateDate:o,DocTime:a,...r}=e,n=new Date(o).toLocaleDateString("en-US"),l=Math.floor(a/100).toString().padStart(2,"0"),s=(a%100).toString().padStart(2,"0"),i="".concat(l,":").concat(s),c=Object.fromEntries(Object.entries(r).map(e=>{let[t,o]=e;return[t,isNaN(o)?o:parseFloat(o).toFixed(3)]}));return{...c,CreateDateTime:"".concat(n," ").concat(i),DocEntry:t}}),t=e.sort((e,t)=>new Date(e.CreateDateTime)-new Date(t.CreateDateTime)),a=Object.keys(e[0]).map(e=>({field:e,header:e.replace(/([A-Z])/g," $1").trim()})).filter(e=>"DocEntry"!==e.field);m(a),s(t)}}catch(e){console.error("Error fetching mix data:",e),v.current.show({severity:"error",summary:"Error",detail:"Error fetching mix data"})}},x=async e=>{try{let t=await fetch("/api/ProductionMixesBatches?id=".concat(e));if(!t.ok)throw Error("Network response was not ok");let o=await t.json();y(t=>({...t,[e]:o}))}catch(t){console.error("Error fetching batch data for DocEntry ".concat(e,":"),t),v.current.show({severity:"error",summary:"Error",detail:"Error fetching batch data for DocEntry ".concat(e)})}},g=e=>{let t=e.index;if(null===t||t===h)b(null);else if(b(t),l[t]){let e=l[t].DocEntry;e&&!p[e]&&x(e)}},N=(0,a.jsx)("div",{className:"p-d-flex p-jc-end",children:(0,a.jsx)(i.z,{label:"Close",icon:"pi pi-times",className:"p-button-danger",onClick:n})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.F,{ref:v}),(0,a.jsxs)(u.V,{header:"Production Mixes",visible:o,footer:N,onHide:n,children:[(0,a.jsx)("div",{className:"table-header",children:c.map(e=>(0,a.jsx)("span",{className:"table-header-item",children:e.header},e.field))}),(0,a.jsx)(C.J,{activeIndex:h,onTabChange:g,children:l.map((e,t)=>{let o=c.map(t=>(0,a.jsx)("span",{className:"table-header-item",children:e[t.field]},t.field)),r=p[e.DocEntry]?(0,a.jsx)("div",{className:"p-accordion-content",children:Object.entries(p[e.DocEntry][0]).map(e=>{let[t,o]=e;return(0,a.jsxs)("div",{style:{textAlign:"center",flex:1},children:[(0,a.jsxs)("strong",{children:[t,":"]})," ",o]},t)})}):(0,a.jsx)("p",{children:"Loading batch data..."});return(0,a.jsx)(C.U,{header:(0,a.jsx)("div",{children:o}),children:r},t)})})]})]})},E=e=>{let{id:t,visible:o,onHide:n}=e,[c,m]=(0,r.useState)([]),p=(0,r.useRef)(null);(0,r.useEffect)(()=>{t&&o&&y(t)},[t,o]);let y=async e=>{try{let t=await fetch("/api/ProductionPallets?id=".concat(e));if(!t.ok)throw Error("Network response was not ok");let o=await t.json();m(o)}catch(e){console.error("Error fetching pallet data:",e),p.current.show({severity:"error",summary:"Error",detail:"Error fetching pallet data"})}},h=e=>{console.log("View:",e)},b=e=>(c.indexOf(e),c.length,(0,a.jsx)("div",{children:(0,a.jsx)(i.z,{icon:"pi pi-print",className:"p-button-rounded p-button-info p-mr-2",onClick:()=>h(e)})})),v=(0,a.jsx)("div",{className:"p-d-flex p-jc-end",children:(0,a.jsx)(i.z,{label:"Close",icon:"pi pi-times",className:"p-button-danger",onClick:n})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.F,{ref:p}),(0,a.jsx)(u.V,{header:"Production Pallets",visible:o,style:{width:"70vw"},footer:v,onHide:n,children:(0,a.jsxs)(l.w,{value:c,scrollable:!0,scrollHeight:"400px",children:[(0,a.jsx)(s.s,{field:"ID",header:"PalletID"}),(0,a.jsx)(s.s,{field:"PO",header:"PO"}),(0,a.jsx)(s.s,{field:"SKU",header:"SKU"}),(0,a.jsx)(s.s,{field:"LOT",header:"LOT"}),(0,a.jsx)(s.s,{field:"BEST BEFORE",header:"Best Before"}),(0,a.jsx)(s.s,{field:"QTY PER PALLET",header:"Qty/Per Pallet"}),(0,a.jsx)(s.s,{field:"BIN LOCATION",header:"Bin Location"}),(0,a.jsx)(s.s,{body:b,header:"Actions"})]})})]})},F=(e,t)=>{let o=String(t).padStart(4,"0");e instanceof Date||(e=new Date(e));let a=e.toISOString().split("T")[0],r=o.toString().padStart(4,"0"),n=parseInt(r.substring(0,2),10),l=r.substring(2,4),s="".concat(a,"T").concat(String(n).padStart(2,"0"),":").concat(l,":00"),i=new Date(s);return i};var L=function(e){let t=new Date,[o,a,r]=e.split(":").map(Number);return t.setHours(t.getHours()-o),t.setMinutes(t.getMinutes()-a),t.setSeconds(t.getSeconds()-r),t};let O=()=>{var e,t,o,u,m,y,h,b,v,P,g,N,w,f,C,O,I,B,U,Q,k,_,A,q,M,z,X,R,H,W,Y,G,J,V,Z,K,$,ee,et,eo,ea,er,en,el,es,ei,ec,ed,eu,em,ep,ey,eh,eb,ev,eP;let ex=(0,n.useRouter)(),{id:eg}=ex.query,[eN,ew]=(0,r.useState)(null),[eD,ef]=(0,r.useState)(null),[eS,ej]=(0,r.useState)(null),[eC,eT]=(0,r.useState)(null),[eE,eF]=(0,r.useState)(!1),[eL,eO]=(0,r.useState)(!1),[eI,eB]=(0,r.useState)(!1),[eU,eQ]=(0,r.useState)(!1),[ek,e_]=(0,r.useState)(!1),[eA,eq]=(0,r.useState)(null),[eM,ez]=(0,r.useState)(null),[eX,eR]=(0,r.useState)(null),[eH,eW]=(0,r.useState)(null),[eY,eG]=(0,r.useState)(!1),eJ=(0,r.useRef)(null),[eV,eZ]=(0,r.useState)("Are you sure you want to finalize the production? Once the Production Order is closed, you will no longer be able to add new mixes or receive finished goods. If you agree, click OK; otherwise, click Cancel"),[eK,e$]=(0,r.useState)(!1),[e0,e2]=(0,r.useState)(!1),e1="http://localhost:3000/api/backend";console.log(e1);let e3=e=>{if(tn(e.OriginNum),e.ItemCode2.startsWith("PKG")){let t=eN.filter(e=>e.ItemCode2.startsWith("DOH")).map(e=>parseFloat(e.QtyChildrenCmpl-e.IssuedQty)).reduce((e,t)=>e+t,0);t<ek.Flag?(console.log(t),console.log(ek.Flag),eJ.current.show({severity:"warn",summary:"Warning",detail:"There is not enough dough quantity to continue generating pallets. Please complete mixes."})):ex.push("/production/".concat(e.POChildrenDocEntry))}else ex.push("/production/".concat(e.POChildrenDocEntry))},e6=e=>{eT(e),eF(!0)},e4=e=>{eF(!1),eT(null),tl(),eN[0].ProduccionGO&&eO(!0),e2(!1)},e5=e=>{"Mixes"===eN[0].TypeDetail&&eB(!0)},e9=e=>{"Pallets"===eN[0].TypeDetail&&eQ(!0)},e7=()=>{eO(!1),eT(null),tl()},e8=()=>{eB(!1)},te=()=>{eQ(!1)},tt=async()=>{var e;e=new Date(eN[0].pauseDate?F(eN[0].PauseDate,eN[0].PauseTime):F(eN[0].StartDate,eN[0].StartTime));let t=eN[0].DocEntry,o=new Date().toISOString().split("T")[0],a=new Date,r=a.getHours().toString().padStart(2,"0"),n=a.getMinutes().toString().padStart(2,"0"),l="".concat(r).concat(n),s=a-e,i=Math.floor(s%36e5/6e4),c=Math.floor(s%6e4/1e3),d="".concat(Math.floor(s/36e5),":").concat(i<10?"0":"").concat(i,":").concat(c<10?"0":"").concat(c);console.log(d);let u={docEntry:String(t),updateData:{U_CTS_PDate:o,U_CTS_PTime:l,U_CTS_Paused:"Y",U_CTS_CosumeT:d}};console.log(u);try{let e=await fetch("/api/UpdateProductionOrder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),t=await e.json();e.ok?(eJ.current.show({severity:"success",summary:"Success",detail:"Production paused successfully"}),eR(d)):eJ.current.show({severity:"error",summary:"Error",detail:t.message||"An unexpected error occurred"})}catch(e){console.error("Error pausing production:",e),eJ.current.show({severity:"error",summary:"Error",detail:"Failed to pause production"})}tl(),eG(!0)},to=async()=>{if("Y"===eN[0].IsPaused){let e=eN[0].DocEntry,t={docEntry:String(e),updateData:{U_CTS_Paused:"N"}};try{let e=await fetch("/api/UpdateProductionOrder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await e.json();e.ok?eJ.current.show({severity:"success",summary:"Success",detail:"Production resumed successfully"}):eJ.current.show({severity:"error",summary:"Error",detail:o.message||"An unexpected error occurred"})}catch(e){console.error("Error resuming production:",e),eJ.current.show({severity:"error",summary:"Error",detail:"Failed to resume production"})}eW(L(eN[0].ConsumedTime))}tl(),eG(!0)},ta=async()=>{if(!eN[0].StartTime){let e=eN[0].DocEntry,t=new Date().toLocaleDateString(),o=new Date,a=o.getHours(),r=o.getMinutes(),n="".concat(a,":").concat(r);try{let o=localStorage.getItem("Token"),a=await fetch("".concat(e1,"/Production/ProductionOrder"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({DocEntry:e,StartDate:t,U_CTS_STime:n})}),r=await a.json();a.ok?eJ.current.show({severity:"success",summary:"Success",detail:"Production started successfully"}):eJ.current.show({severity:"error",summary:"Error",detail:r.message||"An unexpected error occurred"})}catch(e){console.error("Error starting production:",e),eJ.current.show({severity:"error",summary:"Error",detail:"Failed to start production"})}eq(new Date)}tl(),eG(!0)},tr=async()=>{let e=new Date().toLocaleDateString(),t=localStorage.getItem("Token");console.log("".concat(e1,"/Production/ProductionOrder"));try{let o=eD.map(async o=>{let a={DocEntry:o.DocEntry,docDueDate:e,Status:"Closed"},r=await fetch("".concat(e1,"/Production/ProductionOrder"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(a)}),n=await r.json();r.ok?eJ.current.show({severity:"success",summary:"Success",detail:"Production order ".concat(a.DocEntry," closed successfully")}):eJ.current.show({severity:"error",summary:"Error",detail:n.Message||"An unexpected error occurred"})});await Promise.all(o),tl()}catch(e){console.error("Error closing production orders:",e),eJ.current.show({severity:"error",summary:"Error",detail:"Failed to close production orders"})}ez(new Date),eG(!1),e$(!1)},tn=async e=>{try{let t=await fetch("/api/ControlByPallets?originNum=".concat(e)),o=await t.json();console.log(o),t.ok?(e_(o[0]),console.log(o)):console.error("Error fetching control by pallets:",o.error)}catch(e){console.error("Unexpected error fetching control by pallets:",e)}},tl=async()=>{var e;let t=await fetch("/api/OneProductionOrder/".concat(eg)),o=await t.json();ew(o),console.log(o),ts(null===(e=o[0])||void 0===e?void 0:e.OriginNum);let a=o.every(e=>"Item"===e.Type);ej(a)},ts=async e=>{let t=await fetch("/api/AllPOrdersTortillas?id=".concat(e)),o=await t.json();ef(o)};if((0,r.useEffect)(()=>{eg&&tl()},[eg]),!eN)return(0,a.jsx)("div",{children:"Loading..."});let ti=e=>(console.log(Number(e.QtyChildrenCmpl)-Number(e.IssuedQty)),console.log(Number(ek.Parcial)),(0,a.jsxs)(a.Fragment,{children:["PO"===e.Type&&(0,a.jsx)(i.z,{label:eN[0].CloseDate||"Y"===eN[0].IsPaused?"Review":"Produce",className:"p-button-info",onClick:()=>e3(e),disabled:!eN[0].CloseDate&&(!eN[0].StartTime||eN[0].CloseDate),rounded:!0}),"Item"===e.Type&&(0,a.jsx)(i.z,{label:"Issue",className:"p-button-warning",onClick:()=>e6(e),disabled:!eN[0].StartTime||eN[0].CloseDate,rounded:!0})]})),tc={month:"2-digit",day:"2-digit",year:"numeric"};return(0,a.jsxs)("div",{children:[(0,a.jsx)(d.F,{ref:eJ,position:"top-right",style:{marginTop:"60px",zIndex:9999}}),(0,a.jsx)(c.Z,{title:(0,a.jsxs)("span",{children:[(0,a.jsx)(S,{})," Production Order "]}),className:"p-card",children:(0,a.jsxs)("div",{className:"header-prod",children:[(0,a.jsxs)("div",{className:"p-col-12 p-md-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Status:"})," ",null===(e=eN[0])||void 0===e?void 0:e.Status]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Product No.:"})," ",null===(t=eN[0])||void 0===t?void 0:t.ItemCode]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Product Description:"})," ",null===(o=eN[0])||void 0===o?void 0:o.ProdName]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Planned Quantity:"})," ",Number(null===(u=eN[0])||void 0===u?void 0:u.PlannedQty).toFixed(3)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Warehouse:"})," ",null===(m=eN[0])||void 0===m?void 0:m.Warehouse]})]}),(0,a.jsxs)("div",{className:"p-col-12 p-md-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"No. (PO):"})," ",null===(y=eN[0])||void 0===y?void 0:y.DocNum]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Order Date:"})," ",new Date(null===(h=eN[0])||void 0===h?void 0:h.CreateDate).toLocaleDateString("en-US",tc)]}),!eS&&(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Start Date:"})," ",(null===(b=eN[0])||void 0===b?void 0:b.StartDate)?new Date(null===(v=eN[0])||void 0===v?void 0:v.StartDate).toLocaleDateString("en-US",tc):""]}),!eS&&(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Production Finish Date:"})," ",(null===(P=eN[0])||void 0===P?void 0:P.DueDate)?new Date(null===(g=eN[0])||void 0===g?void 0:g.DueDate).toLocaleDateString("en-US",tc):""]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Linked Customer PO:"})," ",null===(N=eN[0])||void 0===N?void 0:N.CustomerPO]}),eS&&(0,a.jsx)("div",{children:(0,a.jsx)(i.z,{rounded:!0,label:(null===(w=eN[0])||void 0===w?void 0:w.TypeDetail)+": "+((null===(f=eN[0])||void 0===f?void 0:f.TypeDetail)==="Mixes"?null===(C=eN[0])||void 0===C?void 0:C.Mixes:null===(O=eN[0])||void 0===O?void 0:O.Pallets),className:"p-button-warning p-mr-2",onClick:()=>{var e,t,o;(null===(e=eN[0])||void 0===e?void 0:e.TypeDetail)==="Mixes"?e5(null===(t=eN[0])||void 0===t?void 0:t.DocEntry):e9(null===(o=eN[0])||void 0===o?void 0:o.DocEntry)}})})]}),(0,a.jsx)("div",{className:"p-col-12 p-md-6",children:!eS&&(0,a.jsx)(j,{startTime:(null===(I=eN[0])||void 0===I?void 0:I.StartTime)?F(eN[0].StartDate,eN[0].StartTime):eA,endTime:(null===(B=eN[0])||void 0===B?void 0:B.CloseTime)?F(eN[0].CloseDate,eN[0].CloseTime):eM,pauseTime:eX||(null===(U=eN[0])||void 0===U?void 0:U.ConsumedTime),IsPaused:null===(Q=eN[0])||void 0===Q?void 0:Q.IsPaused,restarTime:eH,consumedTime:null===(k=eN[0])||void 0===k?void 0:k.ConsumedTime})}),(0,a.jsxs)("div",{className:"p-col-12 p-md-6",children:[(0,a.jsx)("div",{className:"production-buttons",children:!eS&&(0,a.jsxs)(a.Fragment,{children:[!(null===(_=eN[0])||void 0===_?void 0:_.StartTime)&&(0,a.jsx)(i.z,{label:"Start",icon:"pi pi-play",className:"p-button-success p-mr-2",onClick:ta,disabled:!!eA||(null===(A=eN[0])||void 0===A?void 0:A.StartTime),rounded:!0}),(0,a.jsx)(i.z,{label:"End",icon:"pi-stop-circle",className:"p-button-danger",onClick:()=>e$(!0),disabled:!(null===(q=eN[0])||void 0===q?void 0:q.StartTime)||eN[0].CloseDate,rounded:!0}),(null===(M=eN[0])||void 0===M?void 0:M.IsPaused)==="N"&&(null===(z=eN[0])||void 0===z?void 0:z.StartTime)&&(0,a.jsx)(i.z,{label:"Pause",icon:"pi pi-pause",className:"p-button font-bold",onClick:tt,disabled:(null===(X=eN[0])||void 0===X?void 0:X.IsPaused)==="Y"||eN[0].CloseDate,rounded:!0}),(null===(R=eN[0])||void 0===R?void 0:R.IsPaused)==="Y"&&(0,a.jsx)(i.z,{label:"Resume",icon:"pi-reply",onClick:to,disabled:(null===(H=eN[0])||void 0===H?void 0:H.IsPaused)==="N"||eN[0].CloseDate,rounded:!0,style:{backgroundColor:"#2196F3",borderColor:"#2196F3",color:"#fff"}})]})}),eS&&(0,a.jsx)("div",{className:"production-buttons",children:(0,a.jsx)(i.z,{label:(null===(W=eN[0])||void 0===W?void 0:W.TypeDetail)==="Pallets"?"Add Pallet":"Add Mix",className:"p-button-success p-mr-2",onClick:()=>e6(eN),disabled:eN[0].CloseDate||"Y"===eN[0].ParentPaused||(null===(Y=eN[0])||void 0===Y?void 0:Y.TypeDetail)==="Pallets"&&(null===(G=eN[0])||void 0===G?void 0:G.PalletsFlt)===0||(null===(J=eN[0])||void 0===J?void 0:J.TypeDetail)==="Mixes"&&(null===(V=eN[0])||void 0===V?void 0:V.Mixes)>=Number(null===(Z=eN[0])||void 0===Z?void 0:Z.PlannedQty).toFixed(3),rounded:!0})})]})]})}),(0,a.jsx)(c.Z,{title:"Components",className:"p-card p-mt-3",children:(0,a.jsx)("div",{className:"p-datatable-wrapper",children:(0,a.jsxs)(l.w,{value:eN,paginator:!0,rows:10,scrollable:!0,scrollHeight:"400px",children:[(0,a.jsx)(s.s,{field:"ItemCode2",header:"Product"}),(0,a.jsx)(s.s,{field:"ItemName",header:"Description"}),(0,a.jsx)(s.s,{field:"BaseQtyLine",header:"Base Quantity",body:e=>parseFloat(e.BaseQtyLine).toFixed(3)}),(0,a.jsx)(s.s,{field:"PlannedQtyLine",header:"Planned",body:e=>parseFloat(e.PlannedQtyLine).toFixed(3)}),!eS&&(0,a.jsx)(s.s,{field:"QtyChildrenCmpl",header:"Produced",body:e=>parseFloat(e.QtyChildrenCmpl||0).toFixed(3)}),(0,a.jsx)(s.s,{field:"IssuedQty",header:"Issued",body:e=>parseFloat(e.IssuedQty).toFixed(3)}),!eS&&(0,a.jsx)(s.s,{field:"POChildrenDocNum",header:"Child PO"}),!eS&&(0,a.jsx)(s.s,{body:ti,header:"Actions"})]})})}),(0,a.jsx)(x,{visible:eE,onHide:e4,data:eC,pallet:null===(K=eN[0])||void 0===K?void 0:K.ProduccionGO,onSave:()=>e2(!0),parentEntry:null===($=eN[0])||void 0===$?void 0:$.POParentDocEntry}),(0,a.jsx)(D,{visible:eL,onHide:e7,data:{ItemCode:null===(ee=eN[0])||void 0===ee?void 0:ee.ItemCode,plannedQty:null===(et=eN[0])||void 0===et?void 0:et.PlannedQty,baseEntry:null===(eo=eN[0])||void 0===eo?void 0:eo.DocEntry,dueDate:null===(ea=eN[0])||void 0===ea?void 0:ea.DueDate,DocEntryParent:null===(er=eN[0])||void 0===er?void 0:er.POParentDocEntry,LineNumParent:null===(en=eN[0])||void 0===en?void 0:en.POParentLineNum,warehouse:null===(el=eN[0])||void 0===el?void 0:el.Warehouse,ParentItemCode:null===(es=eN[0])||void 0===es?void 0:es.POParentItemCode,TypePO:null===(ei=eN[0])||void 0===ei?void 0:ei.TypePO,ProduccionGO:null===(ec=eN[0])||void 0===ec?void 0:ec.ProduccionGO,ProdName:null===(ed=eN[0])||void 0===ed?void 0:ed.ProdName,UndXPallet:null===(eu=eN[0])||void 0===eu?void 0:eu.UndXPallet,PlantId:null===(em=eN[0])||void 0===em?void 0:em.PlantId,bestBefore:((e,t)=>{let o=new Date(e),a=parseFloat(t);return o.setDate(o.getDate()+a),o})(new Date,null===(ep=eN[0])||void 0===ep?void 0:ep.BestBeforeDays),binCode:null===(ey=eN[0])||void 0===ey?void 0:ey.BinCode,binEntry:null===(eh=eN[0])||void 0===eh?void 0:eh.AbsEntry,PalletsFlt:null===(eb=eN[0])||void 0===eb?void 0:eb.PalletsFlt}}),(0,a.jsx)(T,{visible:eI,onHide:e8,id:null===(ev=eN[0])||void 0===ev?void 0:ev.DocEntry}),(0,a.jsx)(E,{visible:eU,onHide:te,id:null===(eP=eN[0])||void 0===eP?void 0:eP.POParentDocEntry}),(0,a.jsx)(p,{visible:eK,onHide:()=>e$(!1),onConfirm:tr,text:eV})]})};var I=O}},function(e){e.O(0,[5257,8725,1176,2727,2647,8504,4420,7858,2962,9774,2888,179],function(){return e(e.s=8103)}),_N_E=e.O()}]);